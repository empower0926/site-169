<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <title>Dashboard</title>

    <style>
        body {
            background: #111;
            background-size: cover;
            color: white;
        }

        button {
            background-color: blueviolet;
            color: white;
            padding: 5px 16px;
            border-radius: 4px;
            border: none;
            margin: 12px 0;
        }

        select {
            border: none;
            border-radius: 4px;
            padding: 12px;
            width: 100%;
        }

        option {
            width: 100%;
        }

        @keyframes fade {
            0% {
                opacity: 0;
            }

            25% {
                opacity: 1;
            }

            50% {
                opacity: 1;

            }

            75% {
                opacity: 1;

            }

            100% {
                opacity: 0;

            }
        }

        .currency-btn {
            box-shadow: 1px 1px 5px 0 rgba(153, 153, 153, 0.2), -1px -1px 5px 0 rgba(255, 255, 255, 0.5);
            border-radius: 2px;
            
            padding: 1rem;
            color: white;
            margin-top: 5px;
            height: 75px;
            text-align: center;
        }

        .selected-btn {
            -webkit-box-shadow: inset 1px 1px 5px 0 rgba(0, 0, 0, 0.2), inset -1px -1px 5px 0 rgba(255, 255, 255, 0.5);
            box-shadow: inset 1px 1px 5px 0 rgba(0, 0, 0, 0.2), inset -1px -1px 5px 0 rgba(255, 255, 255, 0.5);
            background-color: gray;
        }
        .postimg{
           
            background-size: cover;
            width: 100%;
            height: 100%;
        }
        .side {
            position: fixed;
            background-color: #111;;
        }

        .main {
            position: absolute;
            right: 0px;
            z-index: 0;
        }
        .ms{
            min-height: 100vh;
            padding-top: 50px; 
        }
        .btn-icon{
            width: 20px;
           margin: auto;
           display: none;
        }
        @media only screen and (max-width: 576px) {
            .currency-btn {
                width: 14%;
                height: auto;

            }

            .side {
               
                display: -ms-flexbox;
                display: flex;
                -ms-flex-wrap: wrap;
                flex-wrap: wrap;
                padding-left: 0;
                margin-bottom: 0;
                list-style: none;
                z-index: 2;
                bottom: 0;
            }
            
            .ms{
                margin-top: 20px;  
                padding-top: 20px;
            }
            .postremovebtn{
                margin-top: 75px;
            }
            .btn-icon{
                display: block;
            }
            .btn-text{
                display: none;
            }
        }
    </style>
</head>

<body onload="loadPosts()">
    <div class="container-fluid">
        <div class="row " >
            <div class="side col-sm-2 p-0 ">
                <div id="bitcoin-mbtn" class="currency-btn selected-btn m-0 mt-2  pr-0 pl-0 "
                    onclick="smoothscroll('#bitcoin-sec','bitcoin')">
                   <div class="btn-text"> Bitcoins</div>  <div class="btn-icon"><img src="assets/img/dashboard/bitcoin.png" style="width: 100%;"></div>
                
                    </div>
                <div id="ethereum-mbtn" class=" currency-btn m-0 mt-2  pr-0 pl-0 "
                    onclick="smoothscroll('#ethereum-sec','ethereum')">
                    <div class="btn-text"> Ethereum</div>
                    <div class="btn-icon"><img src="assets/img/dashboard/ethereum.png" style="width: 100%;"></div>
                
                </div>
                <div id="litecoin-mbtn" class=" currency-btn m-0 mt-2  pr-0 pl-0 "
                    onclick="smoothscroll('#litecoin-sec','litecoin')">
                    <div class="btn-text">Litecoin </div>
                    <div class="btn-icon"><img src="assets/img/dashboard/litecoin.png" style="width: 100%;"></div>
              
                </div>
                <div id="blockchain-mbtn" class=" currency-btn m-0 mt-2  pr-0 pl-0 "
                    onclick="smoothscroll('#blockchain-sec','blockchain')">
                    <div class="btn-text">Blockchain </div>
                    <div class="btn-icon"><img src="assets/img/dashboard/blockchain.png" style="width: 100%;"></div>
              
                </div>
                <div id="defi-mbtn" class=" currency-btn m-0 mt-2  pr-0 pl-0 "
                    onclick="smoothscroll('#defi-sec','defi')">
                    <div class="btn-text"> Defi</div> 
                    <div class="btn-icon"><img src="assets/img/dashboard/defi.png" style="width: 100%;"></div>
              
                </div>
                <div id="business-mbtn" class=" currency-btn m-0 mt-2  pr-0 pl-0 "
                    onclick="smoothscroll('#business-sec','business')">
                    <div class="btn-text">Business </div>
                    <div class="btn-icon"><img src="assets/img/dashboard/international-business.png" style="width: 100%;"></div>
              
                </div>
                <div id="news-mbtn" class=" currency-btn m-0 mt-2  pr-0 pl-0 "
                    onclick="smoothscroll('#news-sec','news')">
                    <div class="btn-text"> News</div>
                    <div class="btn-icon"><img src="assets/img/dashboard/newspaper.png" style="width: 100%;"></div>
              
                </div>

            </div>
            <div class=" main col-sm-10 ">
                <main>
                    <section id="bitcoin-sec" class="bitcoin-sec ms  " >
                        <div class="container">
                            <h2>Bitcoins</h2>


                            <div class="row mt-5">
                                <div class="col-sm-6">
                                    <h1> Post count <span id="bitcoincount" style="font-size: 5rem"></span></h1>
                                </div>
                                <div class="col-sm-6">
                                    <h4>choose bitcoin news to show</h4>
                                    <select name="bitcoin_news" id="bitcoin_news">
                                    </select>
                                    <button onclick="addPost('bitcoin_news')">ADD</button>
                                    <div class="d-flex justify-content-end">
                                        <div style="opacity: 0" id="bitcoin_news_success">
                                            <span style="color: green">Post Successfully Added</span>
                                            <img style="width: 22px;"
                                                src="https://res.cloudinary.com/sapiangroup/image/upload/v1605735619/flash-group-news/success_wy6hel.svg"
                                                alt="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row ">
                                <div id="bitcoin_posts" class="row w-100"></div>
                            </div>

                        </div>
                    </section>

                    <section id="ethereum-sec" class="ethereum-sec ms " >
                        <div class="container">
                            <h2>Ethereum</h2>
                            <div class="row mt-5">
                                <div class="col-sm-6">
                                    <h1> Post count <span id="ethereumcount" style="font-size: 5rem"></span></h1>
                                </div>
                                <div class="col-sm-6">
                                    <h4>choose Ethereum news to show</h4>
                                    <select name="ethereum_news" id="ethereum_news">
                                    </select>
                                    <button onclick="addPost('ethereum_news')">ADD</button>
                                    <div class="d-flex justify-content-end">
                                        <div style="opacity: 0" id="ethereum_news_success">
                                            <span style="color: green">Post Successfully Added</span>
                                            <img style="width: 22px;"
                                                src="https://res.cloudinary.com/sapiangroup/image/upload/v1605735619/flash-group-news/success_wy6hel.svg"
                                                alt="">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row ">
                                <div id="ethereum_posts" class="row w-100"></div>
                            </div>
                        </div>
                    </section>

                    <section id="litecoin-sec" class="litecoin-sec ms " >
                        <div class="container">
                            <h2>Litecoin</h2>
                            <div class="row mt-5">
                                <div class="col-sm-6">
                                    <h1> Post count <span id="litecoincount" style="font-size: 5rem"></span></h1>
                                </div>
                                <div class="col-sm-6">
                                    <h4>choose litecoin news to show</h4>
                                    <select name="litecoin_news" id="litecoin_news">
                                    </select>
                                    <button onclick="addPost('litecoin_news')">ADD</button>
                                    <div class="d-flex justify-content-end">
                                        <div style="opacity: 0" id="litecoin_news_success">
                                            <span style="color: green">Post Successfully Added</span>
                                            <img style="width: 22px;"
                                                src="https://res.cloudinary.com/sapiangroup/image/upload/v1605735619/flash-group-news/success_wy6hel.svg"
                                                alt="">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row ">
                                <div id="litecoin_posts" class="row w-100"></div>
                            </div>
                        </div>
                    </section>

                    <section id="blockchain-sec" class="blockchain-sec ms " >
                        <div class="container">
                            <h2>Blockchain</h2>
                            <div class="row mt-5">
                                
                                <div class="col-sm-6">
                                    <h4>choose Blockchain news to show</h4>
                                    <select name="blockchain_news" id="blockchain_news">
                                    </select>
                                    <button onclick="addPost('blockchain_news')">ADD</button>
                                    <div class="d-flex justify-content-end">
                                        <div style="opacity: 0" id="blockchain_news_success">
                                            <span style="color: green">Post Successfully Added</span>
                                            <img style="width: 22px;"
                                                src="https://res.cloudinary.com/sapiangroup/image/upload/v1605735619/flash-group-news/success_wy6hel.svg"
                                                alt="">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row ">
                                <div id="blockchain_posts" class="row w-100"></div>
                            </div>
                        </div>
                    </section>

                    <section id="defi-sec" class="defi-sec ms " >
                        <div class="container">
                            <h2>Defi</h2>
                            <div class="row mt-5">
                                
                                <div class="col-sm-6">
                                    <h4>choose Defi news to show</h4>
                                    <select name="defi_news" id="defi_news">
                                    </select>
                                    <button onclick="addPost('defi_news')">ADD</button>
                                    <div class="d-flex justify-content-end">
                                        <div style="opacity: 0" id="defi_news_success">
                                            <span style="color: green">Post Successfully Added</span>
                                            <img style="width: 22px;"
                                                src="https://res.cloudinary.com/sapiangroup/image/upload/v1605735619/flash-group-news/success_wy6hel.svg"
                                                alt="">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row ">
                                <div id="defi_posts" class="row w-100"></div>
                            </div>
                        </div>
                    </section>

                    <section id="business-sec" class="business-sec ms " >
                        <div class="container">
                            <h2>Business</h2>
                            <div class="row mt-5">
                               
                                <div class="col-sm-6">
                                    <h4>choose business news to show</h4>
                                    <select name="business_news" id="business_news">
                                    </select>
                                    <button onclick="addPost('business_news')">ADD</button>
                                    <div class="d-flex justify-content-end">
                                        <div style="opacity: 0" id="business_news_success">
                                            <span style="color: green">Post Successfully Added</span>
                                            <img style="width: 22px;"
                                                src="https://res.cloudinary.com/sapiangroup/image/upload/v1605735619/flash-group-news/success_wy6hel.svg"
                                                alt="">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row ">
                                <div id="business_posts" class="row w-100"></div>
                            </div>
                        </div>
                    </section>

                    <section id="news-sec" class="news-sec ms " >
                        <div class="container">
                            <h2>News</h2>
                            <div class="row mt-5">
                                
                                <div class="col-sm-6">
                                    <h4>choose News news to show</h4>
                                    <select name="news_news" id="news_news">
                                    </select>
                                    <button onclick="addPost('news_news')">ADD</button>
                                    <div class="d-flex justify-content-end">
                                        <div style="opacity: 0" id="news_news_success">
                                            <span style="color: green">Post Successfully Added</span>
                                            <img style="width: 22px;"
                                                src="https://res.cloudinary.com/sapiangroup/image/upload/v1605735619/flash-group-news/success_wy6hel.svg"
                                                alt="">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row ">
                                <div id="news_posts" class="row w-100"></div>
                            </div>
                        </div>
                    </section>


                </main>

            </div>
        </div>
    </div>


    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>


    <script>

        const BITCOIN = 2;
        const BLOCKCHAIN = 3;
        const BUSINESS = 131;
        const DEFI = 30;
        const ETHEREUM = 4;
        const NEWS = 7;

        let bitcoinPost;
        let blockchainPost;
        let businessPost;
        let defiPost;
        let ethoinPost;
        let newsoinPost;

        const bitcoinSelect = document.querySelector('#bitcoin_news');
        const blockchainSelect = document.querySelector('#blockchain_news');
        const ethereumSelect = document.querySelector('#ethereum_news');
        const litecoinSelect = document.querySelector('#litecoin_news');
        const defiSelect = document.querySelector('#defi_news');
        const businessSelect = document.querySelector('#business_news');
        const newsSelect = document.querySelector('#news_news');

        getData(getURL(BITCOIN)).then((posts) => {
            addOptions(bitcoinSelect, posts);
        });

        getData(getURL(BLOCKCHAIN)).then((posts) => {
            addOptions(blockchainSelect, posts);
        });

        getData(getURL(ETHEREUM)).then((posts) => {
            addOptions(ethereumSelect, posts);
        });
        getData(getURL(DEFI)).then((posts) => {
            addOptions(defiSelect, posts);
        });

        getData(getURL(BUSINESS)).then((posts) => {
            addOptions(businessSelect, posts);
        });

        getData(getURL(NEWS)).then((posts) => {
            addOptions(newsSelect, posts);
        });

        function getURL(topic) {
            return 'https://flashgroupnews.com/wp-json/wp/v2/posts?categories=' + topic + '&per_page=100';
        }

        function addOptions(selection, posts) {
            for (i = 0; i < posts.length; i++) {
                let option = document.createElement('option');
                option.value = JSON.stringify(posts[i]);
                option.innerHTML = i + 1 + '. ' + posts[i].title.rendered;
                selection.appendChild(option);
            }
        }

        async function getData(url) {
            const res = await fetch(url);
            return await res.json();
        }
        const imgURL = "https://flashgroupnews.com/wp-json/wp/v2/media/";

        async function addPost(topic) {

            let selected = document.getElementById(topic);
            let post = selected.value;
            let id = JSON.parse(post).id;
            let imageSrc;
            let imageSrctm;
            setData(imgURL + JSON.parse(post).featured_media).then((val) => {
                if (val.media_type == "image") {
                    let src = val.media_details.sizes.large;
                    if (src === undefined) {
                        src = val.media_details.sizes.medium.source_url;
                    } else {
                        src = val.media_details.sizes.large.source_url;
                    }
                    if (src === undefined) {
                        src = val.media_details.sizes.thumbnail.source_url;
                    }
                    imageSrc = src;
                    imageSrctm = val.media_details.sizes.thumbnail.source_url;
                }
            });
            setTimeout(function () {
                let jsonArticle = { 'category': topic, 'id': id, "limg": imageSrc, "tmimg": imageSrctm, 'post': post };

                const options = {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(jsonArticle)
                };
                const response = fetch('/addPost', options).then((response) => {
                    console.log(response.status);
                    let stat = document.getElementById(topic + "_success");
                    let message = stat.querySelector('span');
                    let sign = stat.querySelector('img');

                    if (response.status === 200) {
                        message.innerHTML = 'Post successfully added';
                        message.style.color = 'green';
                        loadPosts();
                        sign.src = 'https://res.cloudinary.com/sapiangroup/image/upload/v1605735619/flash-group-news/success_wy6hel.svg';
                    } else if (response.status === 304) {
                        message.innerHTML = 'Post already added';
                        message.style.color = 'orange';
                        sign.src = 'https://res.cloudinary.com/sapiangroup/image/upload/v1605736923/flash-group-news/warning_g7bcea.svg';
                    } else if (response.status === 305) {
                        message.innerHTML = 'Post limit reached';
                        message.style.color = 'orange';
                        sign.src = 'https://res.cloudinary.com/sapiangroup/image/upload/v1605736923/flash-group-news/warning_g7bcea.svg';
                    } else {
                        message.innerHTML = 'Something went wrong, please try again';
                        message.style.color = 'red';
                        sign.src = 'https://res.cloudinary.com/sapiangroup/image/upload/v1605736635/flash-group-news/error_tuprkl.svg';
                    }

                    stat.style.animation = 'fade ease-in-out 3.5s';
                    setTimeout(() => {
                        stat.removeAttribute('style');
                        stat.style.opacity = '0';
                    }, 3500);
                });
               

            }, 3000);
            
        }
        async function removePost(id, topic) {

            let jsonArticle = { 'id': id, 'category': topic };
            const options = {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(jsonArticle)
            };
            const response = fetch('/removePost', options).then((response) => {
                console.log(response.status);
            });
            loadPosts();

        }



        async function setData(url) {
            let data = await fetch(url);
            return await data.json();
        }
        let array = ['bitcoin', 'ethereum', 'litecoin', 'blockchain','defi','business','news'];
        function loadPosts() {
            
            for (let index = 0; index < array.length; index++) {
                const element = array[index];
                getData('/getPosts?category=' + element + '_news').then((posts) => {
                    let Posts = document.querySelector('#' + element + '_posts');
                    Posts.innerHTML = "";
                    let postcount = 0;
                    for (i = 0; i < posts.length; i++) {
                        const post = JSON.parse(posts[i].post);

                        const col = document.createElement('div');
                        col.className = 'col-sm-5 m-4';

                        const colDiv = document.createElement('div');
                        colDiv.className = 'row d-flex';
                        colDiv.style.height = '100px';
                        Posts.appendChild(col);
                        col.appendChild(colDiv);
                        const titlepdiv = document.createElement('div');
                        titlepdiv.className = 'col-sm-9';
                        const titlep = document.createElement('p');
                        titlep.color = '#fff';
                        titlep.style = "max-height: 100px;overflow: hidden;";
                        titlep.innerHTML = post.title.rendered;
                        titlepdiv.appendChild(titlep);
                        colDiv.appendChild(titlepdiv);
                        const postDiv = document.createElement('div');
                        postDiv.className = 'col-sm-3 postimg';
                        postDiv.style.background = 'url(' + posts[i].tmimg + ')no-repeat center center / cover ';
                         colDiv.appendChild(postDiv);
                        const removebtn = document.createElement('button');
                        removebtn.className = 'btn btn-danger mt-0';
                        removebtn.innerHTML = "Remove"
                        let btnDiv = document.createElement('div');
                        btnDiv.className = "row postremovebtn";
                        col.appendChild(btnDiv);
                        btnDiv.appendChild(removebtn);
                        removebtn.setAttribute('onClick', 'removePost(' + post.id + ',"' + element + '_news")');
                        postcount++;
                    }
                    if(element==='bitcoin' || element==='ethereum' || element==='litecoin'){
                        document.getElementById('' + element + 'count').innerHTML = postcount;
                    }
                   

                });

            }
        }


        function smoothscroll(hash, topic) {
            for (let index = 0; index < array.length; index++) {
                const element = array[index];

                if (element === topic) {

                    document.getElementById(element + '-mbtn').className = "col-sm-12 currency-btn selected-btn mt-2  pr-0 pl-0 ";
                } else {

                    document.getElementById(element + '-mbtn').className = "col-sm-12 currency-btn mt-2  pr-0 pl-0 ";
                }

            }
            $("html, body").animate(
                {
                    scrollTop: $(hash).offset().top,
                },
                800,
                function () {
                    window.location.hash = hash;
                }
            );
        }
    </script>
</body>

</html>